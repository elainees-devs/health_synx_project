{% extends "base.html" %}

{% block title %}All Patients Vitals{% endblock %}
{% block header %}All Patients Vitals{% endblock %}

{% block content %}

<a href="{% url 'nurse_dashboard' %}" class="button">&larr; Back</a>

<table style="border-collapse: collapse; width: 100%;">
    <thead>
        <tr>
            <th style="border: 1px solid #000; padding: 8px;">#</th>
            <th style="border: 1px solid #000; padding: 8px;">Patient Name</th>
            <th style="border: 1px solid #000; padding: 8px;">Temperature (Â°C)</th>
            <th style="border: 1px solid #000; padding: 8px;">Pulse Rate (bpm)</th>
            <th style="border: 1px solid #000; padding: 8px;">Recorded At</th>
            <th style="border: 1px solid #000; padding: 8px;">Action</th>
        </tr>
    </thead>
    <tbody>
        {% for patient, vitals in patient_vitals.items %}
            {% with latest_vital=vitals|first %}
            <tr>
                <td style="border: 1px solid #000; padding: 8px;">{{ forloop.counter }}</td>
                <td style="border: 1px solid #000; padding: 8px;">{{ patient.first_name }} {{ patient.last_name }}</td>
                <td style="border: 1px solid #000; padding: 8px;">{{ latest_vital.temperature }}</td>
                <td style="border: 1px solid #000; padding: 8px;">{{ latest_vital.pulse_rate }}</td>
                <td style="border: 1px solid #000; padding: 8px;">{{ latest_vital.recorded_at }}</td>
                <td style="border: 1px solid #000; padding: 8px;">
                    <a href="{% url 'add_patient_to_queue' patient.id %}" class="button">
                        Add to Doctor Queue
                    </a>
                </td>
            </tr>
            {% endwith %}
        {% empty %}
        <tr>
            <td colspan="6" style="border: 1px solid #000; padding: 8px; text-align:center;">No vitals recorded yet.</td>
        </tr>
        {% endfor %}
    </tbody>
    <tfoot>
        <tr>
            <td colspan="6" style="border: 1px solid #000; padding: 8px; text-align:right;">
                <strong>Total Patients: {{ patient_vitals|length }}</strong>
            </td>
        </tr>
    </tfoot>
</table>

{% endblock %}
